From 126a63f03f64942334a6bdd66f86256652f7bee6 Mon Sep 17 00:00:00 2001
From: Kartatz <105828205+Kartatz@users.noreply.github.com>
Date: Sat, 4 Oct 2025 00:29:41 -0300
Subject: [PATCH 11/11] Revert "configure: Always add pre-installed header
 directories to search path"

---
 configure    | 16 ++++++----------
 configure.ac | 16 ++++++----------
 2 files changed, 12 insertions(+), 20 deletions(-)

diff --git a/configure b/configure
index 54b71af5d..ca1b88064 100755
--- a/configure
+++ b/configure
@@ -11650,17 +11650,13 @@ if test x"${build}" = x"${host}" ; then
   LDFLAGS_FOR_BUILD=${LDFLAGS_FOR_BUILD-${LDFLAGS}}
 fi
 
-if test -d ${srcdir}/gcc; then
-  # On Canadian crosses, we'll be searching the right directories for the
-  # previously-installed cross compiler, so don't bother to add flags for
-  # executable directories within the install tree of the compiler being built;
-  # programs in there won't even run.
-  if test "${build}" = "${host}"; then
-    FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/'
-  fi
-
+# On Canadian crosses, we'll be searching the right directories for
+# the previously-installed cross compiler, so don't bother to add
+# flags for directories within the install tree of the compiler
+# being built; programs in there won't even run.
+if test "${build}" = "${host}" && test -d ${srcdir}/gcc; then
   # Search for pre-installed headers if nothing else fits.
-  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
+  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/ -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
 fi
 
 if test "x${use_gnu_ld}" = x &&
diff --git a/configure.ac b/configure.ac
index 2996a1242..4126bd157 100644
--- a/configure.ac
+++ b/configure.ac
@@ -3829,17 +3829,13 @@ if test x"${build}" = x"${host}" ; then
   LDFLAGS_FOR_BUILD=${LDFLAGS_FOR_BUILD-${LDFLAGS}}
 fi
 
-if test -d ${srcdir}/gcc; then
-  # On Canadian crosses, we'll be searching the right directories for the
-  # previously-installed cross compiler, so don't bother to add flags for
-  # executable directories within the install tree of the compiler being built;
-  # programs in there won't even run.
-  if test "${build}" = "${host}"; then
-    FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/'
-  fi
-
+# On Canadian crosses, we'll be searching the right directories for
+# the previously-installed cross compiler, so don't bother to add
+# flags for directories within the install tree of the compiler
+# being built; programs in there won't even run.
+if test "${build}" = "${host}" && test -d ${srcdir}/gcc; then
   # Search for pre-installed headers if nothing else fits.
-  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
+  FLAGS_FOR_TARGET=$FLAGS_FOR_TARGET' -B$(build_tooldir)/bin/ -B$(build_tooldir)/lib/ -isystem $(build_tooldir)/include -isystem $(build_tooldir)/sys-include'
 fi
 
 if test "x${use_gnu_ld}" = x &&
-- 
2.50.1

